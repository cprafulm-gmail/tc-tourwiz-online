import React from "react";
import { Link } from "react-router-dom";
import CartItems from "../components/cart/cart-items";
//import PriceBreakup from "../components/cart/price-breakup";
import CartLoading from "../components/cart/cart-loading";
import Travellers from "../components/cart/travellers";
import BookingSteps from "../components/common/booking-steps";
import ModelPopup from "../helpers/model";
import CartBase from "../base/cart-base";
import { Trans } from "../helpers/translate";
import * as Global from "../helpers/global";
import main from "react-intl-tel-input";

class CartManualBooking extends CartBase {
  constructor(props) {
    super(props);
    this.state = {
      page: "cart",
      isLoading: true,
      cart: null,
      cartId: localStorage.getItem("cartLocalId"),
      isRemoveCartLoading: null,
      showPopup: false,
      popupTitle: "",
      popupContent: null,
      specialRequest: [],
      personateDetails: null,
      continueAsGuest: false,
      PriceChangeSoldOut: [],
    };
    if (sessionStorage.getItem("callCenterType") !== undefined && (sessionStorage.getItem("callCenterType") === "Customer" || sessionStorage.getItem("callCenterType") === "Agent")) {
      this.getPersonateDetails();
    }
  }

  componentDidMount() {
    window.scrollTo(0, 0);
    this.viewCartManualBooking();
  }


  viewCartManualBooking = () => {
    let cartItem = [];
    var quotationItems = localStorage.getItem("ManualBooking");
    let items = quotationItems ? JSON.parse(quotationItems) : [];
    let data = ({ response: { "paymentGatewayCharges": { "actlpayment": [{ "amount": 37, "purpose": "1" }, { "amount": 0, "purpose": "116" }, { "amount": 37, "purpose": "10" }], "stripeauthorizecapture": [{ "amount": 37, "purpose": "1" }, { "amount": 0, "purpose": "116" }, { "amount": 37, "purpose": "10" }], "dummy": [{ "amount": 37, "purpose": "1" }, { "amount": 0, "purpose": "116" }, { "amount": 37, "purpose": "10" }] }, "cartID": "9eed542f-81c6-4333-b26b-073c0dc09b4f", "isLocked": false, "isBooked": false, "items": [{ "isBookable": true, "isLocked": false, "availabilityStatus": 0, "cartItemID": "5cac1a2f-3285-480d-bfa2-05ec5ba1f1dc", "cartID": "9eed542f-81c6-4333-b26b-073c0dc09b4f", "detailsID": "124962", "isFromPayLater": false, "isFromModification": false, "token": "739da9df-23a4-46ad-af7c-209968f1b7a0", "data": { "optionalAmenities": [], "ratingInfo": [{ "type": "tripAdvisor", "rating": 2, "ratersCount": 124, "image": { "url": "https://www.tripadvisor.com/img/cdsi/img2/ratings/traveler/2.0-39958-4.png", "updatedDate": "0001-01-01T00:00:00", "isDefault": false } }], "rating": 3, "ratersCount": 0, "category": "Hotel", "url": "", "items": [{ "id": "room_group_0_2_0_0", "amount": -1, "displayAmount": "$ (1.00)", "strikeThroughAmount": 0, "originalAmount": 0, "paxInfo": [{ "code": "default", "sequence": 0, "properties": {}, "item": [{ "type": 0, "typeString": "ADT", "max": 0, "min": 0, "quantity": 2, "displayRateInfo": [], "breakDownRateInfo": [], "paymentGatewayChargeDetails": [] }, { "type": 2, "typeString": "INF", "max": 0, "min": 0, "quantity": 0, "displayRateInfo": [], "breakDownRateInfo": [], "paymentGatewayChargeDetails": [] }, { "type": 1, "typeString": "CHD", "max": 0, "min": 0, "quantity": 0, "displayRateInfo": [], "breakDownRateInfo": [], "paymentGatewayChargeDetails": [] }], "config": [], "flags": {} }], "dateInfo": { "startDate": "0001-01-01T00:00:00", "endDate": "0001-01-01T00:00:00" }, "hasSpecialDeal": false, "business": "hotel", "tpExtension": [], "policies": [], "code": "room_group_0_2_0_0", "sequence": 0, "properties": {}, "item": [{ "boardingStatus": false, "age": 0, "boardTypes": [{ "id": "RO", "type": "ROOM ONLY", "priority": 0 }], "name": "DOUBLE STANDARD", "business": "hotel", "objectIdentifier": "room", "code": "i9aiymAfVIFeAvjL/1/hEeq4bGYqyR3jd/lT/Z8YywZ8d1DnxWHWNFfD4dymstte7qkLAW5AHD2aFFkcQUvXTH1brRJfqJJKPtRDumt2sqHn6wvxVObA942YCwAhASiebEPBLZ1BYQfBWt40ociLu8DV291MYW4Qr4S+Ep6WxJ157DCBWMLE/4iQXL+dnOlz", "token": "20201207|20201209|W|148|124962|DBL.ST|FIT-RO|RO||1~2~0||N@06~~21c24~567777612~N~~~NRF~250EF0A2B693489160696719381000AAUS0000001000000000521c24:1", "tpExtension": [{ "key": "roomToken" }, { "key": "roomTypeDescription", "value": "" }, { "key": "adults", "value": "2" }, { "key": "children", "value": "0" }, { "key": "childages", "value": "" }, { "key": "infants", "value": "0" }, { "key": "characteristic", "value": "" }, { "key": "groupId", "value": "1" }, { "key": "promotionName", "value": "" }, { "key": "promotionCriteriaValue", "value": "" }], "secureTPExtension": [], "status": "Available", "dateInfo": { "startDate": "0001-01-01T00:00:00", "endDate": "0001-01-01T00:00:00" }, "description": "", "stopInfo": [], "images": [], "paxInfo": [], "amount": 37, "displayAmount": "$ 37", "strikeThroughAmount": 0, "originalAmount": 0, "policies": [{ "isFromPolicyDetails": false, "isBookAndPayLater": false, "bookAndPayLaterVoidDays": -1, "isDisplayPolicy": false, "id": "", "type": "Cancellation", "name": "", "description": "If cancelled within 7 Days of check in date, user needs to pay $ 37  cancellation charges. <br/> Additional fee and taxes may apply.", "amount": 0, "percentage": 0, "dateInfo": { "startDate": "0001-01-01T00:00:00", "endDate": "0001-01-01T00:00:00" }, "isCurrentPolicy": true, "isPortalPolicy": false, "isItemLevel": false, "isNoShow": false, "criteria": [{ "key": "CancellationAmount", "value": "36.28" }, { "key": "Markup", "value": "0.72" }, { "key": "CancellationChargeValue", "value": "36.28" }, { "key": "CancellationChargeType", "value": "Amount" }, { "key": "CancellationChargeCurrency", "value": "USD" }, { "key": "CancellationChargeUnit", "value": "Days" }, { "key": "CancellationDeadline", "value": "7" }, { "key": "CancellationSupplierAmount", "value": "36.28" }, { "key": "CancellationSupplierCurrency", "value": "USD" }], "config": [] }, { "isFromPolicyDetails": false, "isBookAndPayLater": false, "bookAndPayLaterVoidDays": -1, "isDisplayPolicy": false, "id": "", "type": "Cancellation", "name": "", "description": "Children between 1 - 11 are allowed in parents bed.Tourisum Fees and Cleaning charges guest has to pay directly at the time upon check-in  Estimated total amount of taxes &amp; fees for this booking:20.00 Utd. Arab Emir. Dirham payable on arrival.  Marriage certificate required for a couple to share room.Only Adults 18.Check-in hour 14:00-.Charges for late arrival.Deposit on arrival.Car park YES (without additional debit notes).Minimum check-in age 18.As a result of local government measures and guidelines put in place by services providers – including hotels and ancillaries – guests may find that some facilities or services are not available.Please visit https://static-sources.s3-eu-west-1.amazonaws.com/policy/index.html for further information. (15/05/2020-31/12/2020) ", "amount": 0, "percentage": 0, "dateInfo": { "startDate": "0001-01-01T00:00:00", "endDate": "0001-01-01T00:00:00" }, "isCurrentPolicy": false, "isPortalPolicy": false, "isItemLevel": false, "isNoShow": false, "criteria": [], "config": [] }], "vendors": [{ "sequence": 0, "type": "default", "properties": {}, "item": { "name": "", "provider": "" }, "config": [], "flags": {} }], "seatLayout": [], "displayRateInfo": [{ "amount": 37, "description": "BASEPRICE", "currencyCode": "USD", "purpose": "1" }, { "amount": 37, "description": "PREPAYAMOUNT", "currencyCode": "USD", "purpose": "8" }, { "amount": 37, "description": "TOTALAMOUNT", "currencyCode": "USD", "purpose": "10" }], "breakDownRateInfo": [{ "amount": 18.14, "dateInfo": { "startDate": "2020-12-07T00:00:00", "endDate": "0001-01-01T00:00:00" } }, { "amount": 18.14, "dateInfo": { "startDate": "2020-12-08T00:00:00", "endDate": "0001-01-01T00:00:00" } }], "config": [{ "key": "SupplierPolicy", "value": "36.28#$#2020-12-02T19:59:00+00:00||" }, { "key": "RateClass", "value": "NRF" }, { "key": "RateType", "value": "BOOKABLE" }, { "key": "RR", "value": "fQqJasmxLbp/1ZbEYkFDnA==" }, { "key": "RateComments", "value": "Children between 1 - 11 are allowed in parents bed.Tourisum Fees and Cleaning charges guest has to pay directly at the time upon check-in  Estimated total amount of taxes & fees for this booking:20.00 Utd. Arab Emir. Dirham payable on arrival.  Marriage certificate required for a couple to share room.Only Adults 18.Check-in hour 14:00-.Charges for late arrival.Deposit on arrival.Car park YES (without additional debit notes).Minimum check-in age 18.As a result of local government measures and guidelines put in place by services providers – including hotels and ancillaries – guests may find that some facilities or services are not available.Please visit https://static-sources.s3-eu-west-1.amazonaws.com/policy/index.html for further information. (15/05/2020-31/12/2020) " }, { "key": "RateKey", "value": "20201207|20201209|W|148|124962|DBL.ST|FIT-RO|RO||1~2~0||N@06~~21c24~567777612~N~~~NRF~250EF0A2B693489160696719381000AAUS0000001000000000521c24" }, { "key": "roomIdentifier", "value": "DBL.ST" }], "flags": { "isRefundable": false, "isClaimbackAvailable": false }, "stops": 0, "layOverDuration": 0, "journeyDuration": 0, "availabilityCount": 1, "sequenceNumber": 0, "amenities": [], "features": [], "paymentGatewayInfo": [{ "gatewayType": "ACTLPayment", "chargeType": "Percentage", "chargeValue": 0, "chargeAmount": 0 }, { "gatewayType": "StripeAuthorizeCapture", "chargeType": "Percentage", "chargeValue": 0, "chargeAmount": 0 }], "displayPriority": 0, "hasSpecialDeal": false, "specialDealID": "", "specialDealDescription": "", "viewCount": 0, "quantity": 0 }], "config": [], "flags": { "isGroupedRooms": false } }], "isCheckAvailEnabled": false, "stopDetails": [], "totalDuration": 0, "ticketTimeLimit": "0001-01-01T00:00:00", "documents": [], "additionalParams": [], "cancellationPeriod": -1, "currencyRefCode": "28503", "expiryPeriod": 0, "customerClassID": "", "name": "Dubai Palm", "business": "hotel", "objectIdentifier": "hotel", "code": "", "token": "", "id": "124962", "tpExtension": [{ "key": "locationCode", "value": "AE2" }, { "key": "hotelCommonCode", "value": "" }, { "key": "hotelChain", "value": "" }, { "key": "searchDateTime", "value": "" }, { "key": "searchCount", "value": "" }, { "key": "checkAvailId", "value": "cbaf84ef-564a-485b-ba32-9fd8fa9396ff" }, { "key": "bookAndPayLaterVoidDays", "value": "2" }], "secureTPExtension": [], "status": "available", "dateInfo": { "startDate": "2020-12-07T00:00:00", "endDate": "2020-12-09T00:00:00", "startTime": "", "endTime": "" }, "description": "Dubai Palm Hotel is located in Deira, within walking distance from Al Ghurair Centre and Reef Mall. All of the spacious accommodations feature an individually controlled air conditioning, satellite TV, mini-fridge, hair dryer and IDD telephone. Safe deposit box is available at the reception. The hotel offers 2 restaurants and several night clubs that are located at the mezzanine floor. In room dining is also available via room service. Major attractions in Dubai include the Dubai Mall, Burj Khalifa, Mall of the Emirates, Gold Souk, Madinat Souk, Dubai Museum and the Palm Jumeirah. The Dubai Palm Hotel is approximately 10 minutes from Dubai International Airport.", "locationInfo": { "fromLocation": { "countryID": "AE", "country": "United Arab Emirates", "latitude": -1, "longitude": -1, "priority": 0, "address": "Al Muteena Street, Deira, Dubai PO BOX 21969,   ", "city": "DUBAI", "state": "", "zipCode": "" }, "toLocation": { "latitude": 0, "longitude": 0, "priority": 0 } }, "stopInfo": [], "images": [{ "title": "Restaurant", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_r_001.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "", "isDefault": true }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_003.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "DBL.ST-4", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_005.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_004.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_007.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_006.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_007.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "DBL.DX", "isDefault": false }, { "title": "Lobby", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_l_001.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_008.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "SGL.DX", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_005.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "SGL.ST-5", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_009.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "SUI.B1", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_002.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "SGL.ST", "isDefault": false }, { "title": "Bar", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ba_001.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_004.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "SGL.ST-4", "isDefault": false }, { "title": "Bar", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ba_002.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_001.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "DBL.ST", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_001.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_003.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_002.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "", "isDefault": false }, { "title": "General view", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_a_002.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "", "isDefault": false }, { "title": "General view", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_a_001.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "", "isDefault": false }, { "title": "Room", "url": "http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_006.jpg", "category": "", "description": "", "updatedDate": "0001-01-01T00:00:00", "type": "", "id": "DBL.ST-5", "isDefault": false }], "paxInfo": [], "amount": 37, "displayAmount": "$ 37", "strikeThroughAmount": 0, "originalAmount": 0, "displayOriginalAmount": "$ 0", "policies": [{ "isFromPolicyDetails": true, "isBookAndPayLater": false, "bookAndPayLaterVoidDays": -1, "isDisplayPolicy": false, "id": "", "type": "Cancellation", "name": "", "description": "If you cancel this reservation immediately after booking, user needs to pay $ 37 .", "amount": 0, "percentage": 0, "dateInfo": { "startDate": "0001-01-01T00:00:00", "endDate": "0001-01-01T00:00:00" }, "isCurrentPolicy": true, "isPortalPolicy": false, "isItemLevel": false, "isNoShow": false, "criteria": [{ "key": "CancellationAmount", "value": "36.28" }, { "key": "Markup", "value": "0.72" }, { "key": "CancellationChargeValue", "value": "36.28" }, { "key": "CancellationChargeType", "value": "Amount" }, { "key": "CancellationChargeCurrency", "value": "USD" }, { "key": "CancellationSupplierAmount", "value": "36.28" }, { "key": "CancellationSupplierCurrency", "value": "USD" }], "config": [] }, { "isFromPolicyDetails": true, "isBookAndPayLater": false, "bookAndPayLaterVoidDays": -1, "isDisplayPolicy": false, "id": "", "type": "Cancellation", "name": "", "description": "Note : All Cancellation Policies are based on Date and Time of the destination of the hotel being booked.", "amount": 0, "percentage": 0, "dateInfo": { "startDate": "0001-01-01T00:00:00", "endDate": "0001-01-01T00:00:00" }, "isCurrentPolicy": false, "isPortalPolicy": false, "isItemLevel": false, "isNoShow": false, "criteria": [], "config": [] }], "contactInformation": { "phoneNumber": "0097142710021", "fax": "", "email": "" }, "vendors": [{ "sequence": 0, "type": "default", "properties": {}, "item": { "name": "APITudeHotel", "provider": "APITudeHotelCerti" }, "config": [], "flags": {} }], "seatLayout": [], "displayRateInfo": [{ "amount": 37, "description": "Base Rate", "currencyCode": "USD", "purpose": "1" }, { "amount": 37, "description": "Prepay", "currencyCode": "USD", "purpose": "8" }, { "amount": 37, "description": "Total", "currencyCode": "USD", "purpose": "10" }, { "amount": 37, "description": "TOTALAMOUNT", "currencyCode": "USD", "purpose": "10" }], "breakDownRateInfo": [], "config": [{ "key": "SuppCC", "value": "pWXuq+sNye7zHM+UjuZg4g==" }, { "key": "CallPolicyService", "value": "true" }], "flags": { "isClaimbackAvailable": false, "isComboMode": true, "isAmountPerNight": false, "isSpecialRequest": false, "isBookAndPayLater": false }, "stops": 0, "layOverDuration": 0, "journeyDuration": 0, "availabilityCount": 0, "sequenceNumber": 0, "amenities": [{ "id": "", "name": "Small pets allowed (under 5 kg)", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Large pets allowed (over 5 kg)", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Wheelchair-accessible", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Car park", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Garage", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "24-hour reception", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Wired Internet", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Wi-fi", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Room service", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Laundry service", "type": "", "flags": { "isRoomCompare": false }, "priority": 9 }, { "id": "", "name": "Medical service", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Babysitting service", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "24-hour security", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Air conditioning in public areas", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Hotel safe", "type": "", "flags": { "isRoomCompare": false }, "priority": 5 }, { "id": "", "name": "Currency exchange facilities", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Supermarket", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Bar", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Restaurant", "type": "", "flags": { "isRoomCompare": false }, "priority": 2 }, { "id": "", "name": "Photocopier", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "", "name": "Nightclub", "type": "", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.DX", "name": "Living room", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.DX", "name": "Smoking rooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.DX", "name": "Number of bedrooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.DX", "name": "Room size (sqm)", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.DX", "name": "Wi-fi", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST", "name": "Smoking rooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST", "name": "Room size (sqm)", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST", "name": "Shower", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST", "name": "Number of bedrooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST", "name": "Wi-fi", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST", "name": "Cable TV", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST", "name": "Wake-up service", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST", "name": "Satellite TV ", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST", "name": "Bathroom", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST", "name": "Ironing set", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST", "name": "Living room", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST-4", "name": "Number of bedrooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST-4", "name": "Room size (sqm)", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST-4", "name": "Living room", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST-4", "name": "Wi-fi", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST-4", "name": "Smoking rooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST-5", "name": "Living room", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST-5", "name": "Smoking rooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST-5", "name": "Wi-fi", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST-5", "name": "Room size (sqm)", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "DBL.ST-5", "name": "Number of bedrooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.DX", "name": "Number of bedrooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.DX", "name": "Living room", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.DX", "name": "Room size (sqm)", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.DX", "name": "Smoking rooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.DX", "name": "Wi-fi", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST", "name": "Living room", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST", "name": "Wi-fi", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST", "name": "Number of bedrooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST", "name": "Smoking rooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST", "name": "Room size (sqm)", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST-4", "name": "Room size (sqm)", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST-4", "name": "Number of bedrooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST-4", "name": "Smoking rooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST-4", "name": "Living room", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST-4", "name": "Wi-fi", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST-5", "name": "Number of bedrooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST-5", "name": "Living room", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST-5", "name": "Smoking rooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST-5", "name": "Room size (sqm)", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SGL.ST-5", "name": "Wi-fi", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SUI.B1", "name": "Number of bedrooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SUI.B1", "name": "Wi-fi", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SUI.B1", "name": "Room size (sqm)", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SUI.B1", "name": "Living room", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }, { "id": "SUI.B1", "name": "Smoking rooms", "type": "Room", "flags": { "isRoomCompare": false }, "priority": 999 }], "features": [], "paymentGatewayInfo": [{ "gatewayType": "ACTLPayment", "chargeType": "Percentage", "chargeValue": 0, "chargeAmount": 0 }, { "gatewayType": "StripeAuthorizeCapture", "chargeType": "Percentage", "chargeValue": 0, "chargeAmount": 0 }], "displayPriority": 0, "hasSpecialDeal": false, "viewCount": 0, "quantity": 0 }, "quantity": 1, "canExpire": false, "createdTime": "2020-12-03T03:47:12", "ttlInSeconds": 0, "bookingStatus": 0, "addons": { "availableAddons": [], "appliedAddons": [] }, "inputs": { "availableInputs": [], "appliedInputs": [] }, "fareBreakup": [{ "amount": 0, "strikeThroughAmount": 0, "originalAmount": 0, "dateInfo": { "startDate": "0001-01-01T00:00:00", "endDate": "0001-01-01T00:00:00" }, "hasSpecialDeal": false, "tpExtension": [], "policies": [], "code": "1", "sequence": 0, "type": "1", "properties": {}, "item": [{ "type": "DOUBLE STANDARD", "code": "DOUBLE STANDARD", "quantity": 1, "displayRateInfo": [{ "amount": 37, "displayAmount": "$ 37", "description": "1", "currencyCode": "USD", "purpose": "1" }], "totalAmount": 37, "displayTotalAmount": "$ 37", "currencyCode": "USD" }], "config": [], "flags": {} }, { "amount": 0, "strikeThroughAmount": 0, "originalAmount": 0, "dateInfo": { "startDate": "0001-01-01T00:00:00", "endDate": "0001-01-01T00:00:00" }, "hasSpecialDeal": false, "tpExtension": [], "policies": [], "code": "10", "sequence": 0, "type": "10", "properties": {}, "item": [{ "type": "", "code": "", "quantity": 1, "displayRateInfo": [{ "amount": 37, "displayAmount": "$ 37", "description": "Total Amount", "currencyCode": "USD", "purpose": "10" }], "totalAmount": 37, "displayTotalAmount": "$ 37", "currencyCode": "USD" }], "config": [], "flags": {} }], "flags": { "isManualItem": false, "isCheckAvailDone": false }, "config": {} }], "travellers": {}, "inputs": { "availableInputs": [{ "code": "promocode", "sequence": -1, "type": "promocode", "properties": {}, "item": [{ "id": "promocode", "type": "promocode", "maxLength": -1, "dateLimit": 0, "isMandatory": false, "appliesOnTraveller": false, "config": [], "images": [], "amount": 0, "calculatedAmount": 0, "quantity": 0, "totalPax": 0 }], "config": [], "flags": {} }], "appliedInputs": [] }, "bookingTransactionStatus": 0, "paymentStatus": 0, "displayCharges": [{ "amount": 37, "description": "BaseFare" }, { "amount": 0, "description": "Baggage" }, { "amount": 0, "description": "MealPreference" }, { "amount": 0, "description": "Insurance" }, { "amount": 0, "description": "OptionalAmenity" }, { "amount": 0, "description": "AdditionalServices" }, { "amount": 0, "description": "Discount" }, { "amount": 37, "description": "Total" }], "enabledPaymentGateways": [] } });

    if (quotationItems !== null && quotationItems !== undefined) {
      if (data.response.items.length === 0) {
        if (this.state.page === "cart-icon") {
          this.setState({
            isLoading: false,
            cart: null,
          });
        }
        if (this.state.page === "cart" || this.state.page === "payment")
          Global.getEnvironmetKeyValue("portalType") === "B2B" ||
            Global.getEnvironmetKeyValue("portalType") === "BOTH"
            ? this.props.history.push(`/Search`)
            : this.props.history.push(`/`);
      } else if (data.response.items.length > 0) {
        JSON.parse(quotationItems).map((item) => {

        });
        var IndividualItemOG = data.response.items[0];
        data.response.items = [];
        var yuuh = [];
        JSON.parse(quotationItems).map((ManualItem) => {
          var IndividualItem = JSON.parse('{"isBookable":true,"isLocked":false,"availabilityStatus":0,"cartItemID":"5cac1a2f-3285-480d-bfa2-05ec5ba1f1dc","cartID":"9eed542f-81c6-4333-b26b-073c0dc09b4f","detailsID":"124962","isFromPayLater":false,"isFromModification":false,"token":"739da9df-23a4-46ad-af7c-209968f1b7a0","data":{"optionalAmenities":[],"ratingInfo":[{"type":"tripAdvisor","rating":2,"ratersCount":124,"image":{"url":"https://www.tripadvisor.com/img/cdsi/img2/ratings/traveler/2.0-39958-4.png","updatedDate":"0001-01-01T00:00:00","isDefault":false}}],"rating":3,"ratersCount":0,"category":"Hotel","url":"","items":[{"id":"room_group_0_2_0_0","amount":-1,"displayAmount":"$ (1.00)","strikeThroughAmount":0,"originalAmount":0,"paxInfo":[{"code":"default","sequence":0,"properties":{},"item":[{"type":0,"typeString":"ADT","max":0,"min":0,"quantity":2,"displayRateInfo":[],"breakDownRateInfo":[],"paymentGatewayChargeDetails":[]},{"type":2,"typeString":"INF","max":0,"min":0,"quantity":0,"displayRateInfo":[],"breakDownRateInfo":[],"paymentGatewayChargeDetails":[]},{"type":1,"typeString":"CHD","max":0,"min":0,"quantity":0,"displayRateInfo":[],"breakDownRateInfo":[],"paymentGatewayChargeDetails":[]}],"config":[],"flags":{}}],"dateInfo":{"startDate":"0001-01-01T00:00:00","endDate":"0001-01-01T00:00:00"},"hasSpecialDeal":false,"business":"hotel","tpExtension":[],"policies":[],"code":"room_group_0_2_0_0","sequence":0,"properties":{},"item":[{"boardingStatus":false,"age":0,"boardTypes":[{"id":"RO","type":"ROOM ONLY","priority":0}],"name":"DOUBLE STANDARD","business":"hotel","objectIdentifier":"room","code":"i9aiymAfVIFeAvjL/1/hEeq4bGYqyR3jd/lT/Z8YywZ8d1DnxWHWNFfD4dymstte7qkLAW5AHD2aFFkcQUvXTH1brRJfqJJKPtRDumt2sqHn6wvxVObA942YCwAhASiebEPBLZ1BYQfBWt40ociLu8DV291MYW4Qr4S+Ep6WxJ157DCBWMLE/4iQXL+dnOlz","token":"20201207|20201209|W|148|124962|DBL.ST|FIT-RO|RO||1~2~0||N@06~~21c24~567777612~N~~~NRF~250EF0A2B693489160696719381000AAUS0000001000000000521c24:1","tpExtension":[{"key":"roomToken"},{"key":"roomTypeDescription","value":""},{"key":"adults","value":"2"},{"key":"children","value":"0"},{"key":"childages","value":""},{"key":"infants","value":"0"},{"key":"characteristic","value":""},{"key":"groupId","value":"1"},{"key":"promotionName","value":""},{"key":"promotionCriteriaValue","value":""}],"secureTPExtension":[],"status":"Available","dateInfo":{"startDate":"0001-01-01T00:00:00","endDate":"0001-01-01T00:00:00"},"description":"","stopInfo":[],"images":[],"paxInfo":[],"amount":37,"displayAmount":"$ 37","strikeThroughAmount":0,"originalAmount":0,"policies":[{"isFromPolicyDetails":false,"isBookAndPayLater":false,"bookAndPayLaterVoidDays":-1,"isDisplayPolicy":false,"id":"","type":"Cancellation","name":"","description":"If cancelled within 7 Days of check in date, user needs to pay $ 37  cancellation charges. <br/> Additional fee and taxes may apply.","amount":0,"percentage":0,"dateInfo":{"startDate":"0001-01-01T00:00:00","endDate":"0001-01-01T00:00:00"},"isCurrentPolicy":true,"isPortalPolicy":false,"isItemLevel":false,"isNoShow":false,"criteria":[{"key":"CancellationAmount","value":"36.28"},{"key":"Markup","value":"0.72"},{"key":"CancellationChargeValue","value":"36.28"},{"key":"CancellationChargeType","value":"Amount"},{"key":"CancellationChargeCurrency","value":"USD"},{"key":"CancellationChargeUnit","value":"Days"},{"key":"CancellationDeadline","value":"7"},{"key":"CancellationSupplierAmount","value":"36.28"},{"key":"CancellationSupplierCurrency","value":"USD"}],"config":[]},{"isFromPolicyDetails":false,"isBookAndPayLater":false,"bookAndPayLaterVoidDays":-1,"isDisplayPolicy":false,"id":"","type":"Cancellation","name":"","description":"Children between 1 - 11 are allowed in parents bed.Tourisum Fees and Cleaning charges guest has to pay directly at the time upon check-in  Estimated total amount of taxes &amp; fees for this booking:20.00 Utd. Arab Emir. Dirham payable on arrival.  Marriage certificate required for a couple to share room.Only Adults 18.Check-in hour 14:00-.Charges for late arrival.Deposit on arrival.Car park YES (without additional debit notes).Minimum check-in age 18.As a result of local government measures and guidelines put in place by services providers – including hotels and ancillaries – guests may find that some facilities or services are not available.Please visit https://static-sources.s3-eu-west-1.amazonaws.com/policy/index.html for further information. (15/05/2020-31/12/2020) ","amount":0,"percentage":0,"dateInfo":{"startDate":"0001-01-01T00:00:00","endDate":"0001-01-01T00:00:00"},"isCurrentPolicy":false,"isPortalPolicy":false,"isItemLevel":false,"isNoShow":false,"criteria":[],"config":[]}],"vendors":[{"sequence":0,"type":"default","properties":{},"item":{"name":"","provider":""},"config":[],"flags":{}}],"seatLayout":[],"displayRateInfo":[{"amount":37,"description":"BASEPRICE","currencyCode":"USD","purpose":"1"},{"amount":37,"description":"PREPAYAMOUNT","currencyCode":"USD","purpose":"8"},{"amount":37,"description":"TOTALAMOUNT","currencyCode":"USD","purpose":"10"}],"breakDownRateInfo":[{"amount":18.14,"dateInfo":{"startDate":"2020-12-07T00:00:00","endDate":"0001-01-01T00:00:00"}},{"amount":18.14,"dateInfo":{"startDate":"2020-12-08T00:00:00","endDate":"0001-01-01T00:00:00"}}],"config":[{"key":"SupplierPolicy","value":"36.28#$#2020-12-02T19:59:00+00:00||"},{"key":"RateClass","value":"NRF"},{"key":"RateType","value":"BOOKABLE"},{"key":"RR","value":"fQqJasmxLbp/1ZbEYkFDnA=="},{"key":"RateComments","value":"Children between 1 - 11 are allowed in parents bed.Tourisum Fees and Cleaning charges guest has to pay directly at the time upon check-in  Estimated total amount of taxes & fees for this booking:20.00 Utd. Arab Emir. Dirham payable on arrival.  Marriage certificate required for a couple to share room.Only Adults 18.Check-in hour 14:00-.Charges for late arrival.Deposit on arrival.Car park YES (without additional debit notes).Minimum check-in age 18.As a result of local government measures and guidelines put in place by services providers – including hotels and ancillaries – guests may find that some facilities or services are not available.Please visit https://static-sources.s3-eu-west-1.amazonaws.com/policy/index.html for further information. (15/05/2020-31/12/2020) "},{"key":"RateKey","value":"20201207|20201209|W|148|124962|DBL.ST|FIT-RO|RO||1~2~0||N@06~~21c24~567777612~N~~~NRF~250EF0A2B693489160696719381000AAUS0000001000000000521c24"},{"key":"roomIdentifier","value":"DBL.ST"}],"flags":{"isRefundable":false,"isClaimbackAvailable":false},"stops":0,"layOverDuration":0,"journeyDuration":0,"availabilityCount":1,"sequenceNumber":0,"amenities":[],"features":[],"paymentGatewayInfo":[{"gatewayType":"ACTLPayment","chargeType":"Percentage","chargeValue":0,"chargeAmount":0},{"gatewayType":"StripeAuthorizeCapture","chargeType":"Percentage","chargeValue":0,"chargeAmount":0}],"displayPriority":0,"hasSpecialDeal":false,"specialDealID":"","specialDealDescription":"","viewCount":0,"quantity":0}],"config":[],"flags":{"isGroupedRooms":false}}],"isCheckAvailEnabled":false,"stopDetails":[],"totalDuration":0,"ticketTimeLimit":"0001-01-01T00:00:00","documents":[],"additionalParams":[],"cancellationPeriod":-1,"currencyRefCode":"28503","expiryPeriod":0,"customerClassID":"","name":"Dubai Palm","business":"hotel","objectIdentifier":"hotel","code":"","token":"","id":"124962","tpExtension":[{"key":"locationCode","value":"AE2"},{"key":"hotelCommonCode","value":""},{"key":"hotelChain","value":""},{"key":"searchDateTime","value":""},{"key":"searchCount","value":""},{"key":"checkAvailId","value":"cbaf84ef-564a-485b-ba32-9fd8fa9396ff"},{"key":"bookAndPayLaterVoidDays","value":"2"}],"secureTPExtension":[],"status":"available","dateInfo":{"startDate":"2020-12-07T00:00:00","endDate":"2020-12-09T00:00:00","startTime":"","endTime":""},"description":"Dubai Palm Hotel is located in Deira, within walking distance from Al Ghurair Centre and Reef Mall. All of the spacious accommodations feature an individually controlled air conditioning, satellite TV, mini-fridge, hair dryer and IDD telephone. Safe deposit box is available at the reception. The hotel offers 2 restaurants and several night clubs that are located at the mezzanine floor. In room dining is also available via room service. Major attractions in Dubai include the Dubai Mall, Burj Khalifa, Mall of the Emirates, Gold Souk, Madinat Souk, Dubai Museum and the Palm Jumeirah. The Dubai Palm Hotel is approximately 10 minutes from Dubai International Airport.","locationInfo":{"fromLocation":{"countryID":"AE","country":"United Arab Emirates","latitude":-1,"longitude":-1,"priority":0,"address":"Al Muteena Street, Deira, Dubai PO BOX 21969,   ","city":"DUBAI","state":"","zipCode":""},"toLocation":{"latitude":0,"longitude":0,"priority":0}},"stopInfo":[],"images":[{"title":"Restaurant","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_r_001.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"","isDefault":true},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_003.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"DBL.ST-4","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_005.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_004.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_007.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_006.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_007.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"DBL.DX","isDefault":false},{"title":"Lobby","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_l_001.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_008.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"SGL.DX","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_005.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"SGL.ST-5","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_009.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"SUI.B1","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_002.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"SGL.ST","isDefault":false},{"title":"Bar","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ba_001.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_004.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"SGL.ST-4","isDefault":false},{"title":"Bar","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ba_002.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_001.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"DBL.ST","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_001.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_003.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_w_002.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"","isDefault":false},{"title":"General view","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_a_002.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"","isDefault":false},{"title":"General view","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_a_001.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"","isDefault":false},{"title":"Room","url":"http://photos.hotelbeds.com/giata/original/12/124962/124962a_hb_ro_006.jpg","category":"","description":"","updatedDate":"0001-01-01T00:00:00","type":"","id":"DBL.ST-5","isDefault":false}],"paxInfo":[],"amount":37,"displayAmount":"$ 37","strikeThroughAmount":0,"originalAmount":0,"displayOriginalAmount":"$ 0","policies":[{"isFromPolicyDetails":true,"isBookAndPayLater":false,"bookAndPayLaterVoidDays":-1,"isDisplayPolicy":false,"id":"","type":"Cancellation","name":"","description":"If you cancel this reservation immediately after booking, user needs to pay $ 37 .","amount":0,"percentage":0,"dateInfo":{"startDate":"0001-01-01T00:00:00","endDate":"0001-01-01T00:00:00"},"isCurrentPolicy":true,"isPortalPolicy":false,"isItemLevel":false,"isNoShow":false,"criteria":[{"key":"CancellationAmount","value":"36.28"},{"key":"Markup","value":"0.72"},{"key":"CancellationChargeValue","value":"36.28"},{"key":"CancellationChargeType","value":"Amount"},{"key":"CancellationChargeCurrency","value":"USD"},{"key":"CancellationSupplierAmount","value":"36.28"},{"key":"CancellationSupplierCurrency","value":"USD"}],"config":[]},{"isFromPolicyDetails":true,"isBookAndPayLater":false,"bookAndPayLaterVoidDays":-1,"isDisplayPolicy":false,"id":"","type":"Cancellation","name":"","description":"Note : All Cancellation Policies are based on Date and Time of the destination of the hotel being booked.","amount":0,"percentage":0,"dateInfo":{"startDate":"0001-01-01T00:00:00","endDate":"0001-01-01T00:00:00"},"isCurrentPolicy":false,"isPortalPolicy":false,"isItemLevel":false,"isNoShow":false,"criteria":[],"config":[]}],"contactInformation":{"phoneNumber":"0097142710021","fax":"","email":""},"vendors":[{"sequence":0,"type":"default","properties":{},"item":{"name":"APITudeHotel","provider":"APITudeHotelCerti"},"config":[],"flags":{}}],"seatLayout":[],"displayRateInfo":[{"amount":37,"description":"Base Rate","currencyCode":"USD","purpose":"1"},{"amount":37,"description":"Prepay","currencyCode":"USD","purpose":"8"},{"amount":37,"description":"Total","currencyCode":"USD","purpose":"10"},{"amount":37,"description":"TOTALAMOUNT","currencyCode":"USD","purpose":"10"}],"breakDownRateInfo":[],"config":[{"key":"SuppCC","value":"pWXuq+sNye7zHM+UjuZg4g=="},{"key":"CallPolicyService","value":"true"}],"flags":{"isClaimbackAvailable":false,"isComboMode":true,"isAmountPerNight":false,"isSpecialRequest":false,"isBookAndPayLater":false},"stops":0,"layOverDuration":0,"journeyDuration":0,"availabilityCount":0,"sequenceNumber":0,"amenities":[{"id":"","name":"Small pets allowed (under 5 kg)","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Large pets allowed (over 5 kg)","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Wheelchair-accessible","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Car park","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Garage","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"24-hour reception","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Wired Internet","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Wi-fi","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Room service","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Laundry service","type":"","flags":{"isRoomCompare":false},"priority":9},{"id":"","name":"Medical service","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Babysitting service","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"24-hour security","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Air conditioning in public areas","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Hotel safe","type":"","flags":{"isRoomCompare":false},"priority":5},{"id":"","name":"Currency exchange facilities","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Supermarket","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Bar","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Restaurant","type":"","flags":{"isRoomCompare":false},"priority":2},{"id":"","name":"Photocopier","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"","name":"Nightclub","type":"","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.DX","name":"Living room","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.DX","name":"Smoking rooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.DX","name":"Number of bedrooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.DX","name":"Room size (sqm)","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.DX","name":"Wi-fi","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST","name":"Smoking rooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST","name":"Room size (sqm)","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST","name":"Shower","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST","name":"Number of bedrooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST","name":"Wi-fi","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST","name":"Cable TV","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST","name":"Wake-up service","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST","name":"Satellite TV ","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST","name":"Bathroom","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST","name":"Ironing set","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST","name":"Living room","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST-4","name":"Number of bedrooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST-4","name":"Room size (sqm)","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST-4","name":"Living room","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST-4","name":"Wi-fi","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST-4","name":"Smoking rooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST-5","name":"Living room","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST-5","name":"Smoking rooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST-5","name":"Wi-fi","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST-5","name":"Room size (sqm)","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"DBL.ST-5","name":"Number of bedrooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.DX","name":"Number of bedrooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.DX","name":"Living room","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.DX","name":"Room size (sqm)","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.DX","name":"Smoking rooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.DX","name":"Wi-fi","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST","name":"Living room","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST","name":"Wi-fi","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST","name":"Number of bedrooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST","name":"Smoking rooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST","name":"Room size (sqm)","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST-4","name":"Room size (sqm)","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST-4","name":"Number of bedrooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST-4","name":"Smoking rooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST-4","name":"Living room","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST-4","name":"Wi-fi","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST-5","name":"Number of bedrooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST-5","name":"Living room","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST-5","name":"Smoking rooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST-5","name":"Room size (sqm)","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SGL.ST-5","name":"Wi-fi","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SUI.B1","name":"Number of bedrooms","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SUI.B1","name":"Wi-fi","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SUI.B1","name":"Room size (sqm)","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SUI.B1","name":"Living room","type":"Room","flags":{"isRoomCompare":false},"priority":999},{"id":"SUI.B1","name":"Smoking rooms","type":"Room","flags":{"isRoomCompare":false},"priority":999}],"features":[],"paymentGatewayInfo":[{"gatewayType":"ACTLPayment","chargeType":"Percentage","chargeValue":0,"chargeAmount":0},{"gatewayType":"StripeAuthorizeCapture","chargeType":"Percentage","chargeValue":0,"chargeAmount":0}],"displayPriority":0,"hasSpecialDeal":false,"viewCount":0,"quantity":0},"quantity":1,"canExpire":false,"createdTime":"2020-12-03T03:47:12","ttlInSeconds":0,"bookingStatus":0,"addons":{"availableAddons":[],"appliedAddons":[]},"inputs":{"availableInputs":[],"appliedInputs":[]},"fareBreakup":[{"amount":0,"strikeThroughAmount":0,"originalAmount":0,"dateInfo":{"startDate":"0001-01-01T00:00:00","endDate":"0001-01-01T00:00:00"},"hasSpecialDeal":false,"tpExtension":[],"policies":[],"code":"1","sequence":0,"type":"1","properties":{},"item":[{"type":"DOUBLE STANDARD","code":"DOUBLE STANDARD","quantity":1,"displayRateInfo":[{"amount":37,"displayAmount":"$ 37","description":"1","currencyCode":"USD","purpose":"1"}],"totalAmount":37,"displayTotalAmount":"$ 37","currencyCode":"USD"}],"config":[],"flags":{}},{"amount":0,"strikeThroughAmount":0,"originalAmount":0,"dateInfo":{"startDate":"0001-01-01T00:00:00","endDate":"0001-01-01T00:00:00"},"hasSpecialDeal":false,"tpExtension":[],"policies":[],"code":"10","sequence":0,"type":"10","properties":{},"item":[{"type":"","code":"","quantity":1,"displayRateInfo":[{"amount":37,"displayAmount":"$ 37","description":"Total Amount","currencyCode":"USD","purpose":"10"}],"totalAmount":37,"displayTotalAmount":"$ 37","currencyCode":"USD"}],"config":[],"flags":{}}],"flags":{"isManualItem":false,"isCheckAvailDone":false},"config":{}}');
          var roomItem = IndividualItem.data.items[0];
          IndividualItem.data.items = [];
          IndividualItem.data.name = ManualItem.name;
          IndividualItem.data.locationInfo.fromLocation.address = ManualItem.toLocation;
          IndividualItem.data.locationInfo.fromLocation.city = ManualItem.toLocation;
          IndividualItem.data.dateInfo.startDate = ManualItem.dates.checkInDate;
          IndividualItem.data.dateInfo.endDate = ManualItem.dates.checkOutDate;
          IndividualItem.data.rating = ManualItem.rating;
          IndividualItem.data.vendors[0].item.name = ManualItem.vendor;
          IndividualItem.data.amount = ManualItem.sellPrice;
          IndividualItem.data.description = ManualItem.description;
          for (let i = 0; i < ManualItem.noRooms; i++) {
            var roomItemTemp = roomItem;
            roomItemTemp.paxInfo[0].item[0].quantity = ManualItem.adult;
            roomItemTemp.paxInfo[0].item[1].quantity = ManualItem.infant;
            roomItemTemp.paxInfo[0].item[2].quantity = ManualItem.child;

            IndividualItem.data.items.push(roomItemTemp);
          }
          yuuh.push(IndividualItem);

        });
        data.response.items = yuuh;
        let defaultPaymentMode = Object.keys(
          data.response.paymentGatewayCharges
        )[0];
        cartItem = data.response.items.filter((x) => (x.isBookable));
        let copyCart = data.response;
        copyCart.items = cartItem;
        this.setState({
          cart: data.response,
          isLoading: false,
          isRemoveCartLoading: null,
          selectedPaymentMode: defaultPaymentMode,
        });
      }
    } else {
      if (this.state.page === "cart-icon") {
        this.setState({
          isLoading: false,
          cart: null,
        });
      }
    }
  };


  render() {
    const { cart, isLoading, personateDetails } = this.state;
    const { isLoggedIn, isLoginMenu } = this.props;
    let { userInfo } = this.props;
    if (sessionStorage.getItem("callCenterType") !== undefined && (sessionStorage.getItem("callCenterType") === "Customer" || sessionStorage.getItem("callCenterType") === "Agent")) {
      if (sessionStorage.getItem("callCenterType") === "Agent" && personateDetails !== null) {
        userInfo.contactInformation.email = personateDetails.customerCareEmail;
      }
      else {
        userInfo = personateDetails
      }
    }
    let tempAvailabilityStatus = false;
    let available = 0;
    if (cart !== undefined && cart !== null) {
      [...Array(cart.items.length).keys()].map(count => {
        if (cart.items[count].availabilityStatus === 3 && available === 0) {
          tempAvailabilityStatus = true;
        }
        else {
          available = available + 1;
          tempAvailabilityStatus = false;
        }
        return true;
      });
    }
    return (
      <div className="cart">
        <BookingSteps isLoggedIn={isLoggedIn} />
        <div className="container">
          {isLoading ? (
            <CartLoading />
          ) : (
            <div className="row mt-4">
              <div className="col-lg-9">
                <CartItems
                  history={this.props.history}
                  match={this.props.match}
                  {...cart}
                  removeCartItem={this.removeCartItemConfirm}
                  isRemoveCartLoading={this.state.isRemoveCartLoading}
                  handleShowSpecialRequest={this.handleShowSpecialRequest}
                  showVehicletermsCondition={this.showVehicletermsCondition}
                  handleAirFareRules={this.handleAirFareRules}
                  specialRequest={this.state.specialRequest}
                />

                {this.renderCartAvailabilityChanged()}

                {isLoggedIn || this.state.continueAsGuest ? sessionStorage.getItem("callCenterType") !== undefined && (sessionStorage.getItem("callCenterType") === "Customer" || sessionStorage.getItem("callCenterType") === "Agent") && personateDetails === null ? "" : (
                  <div className="mt-3">
                    <Travellers
                      {...cart}
                      handleAddTravellers={this.addTravellers}
                      userInfo={userInfo}
                      continueAsGuest={this.state.continueAsGuest}
                    />
                  </div>
                ) : (
                  isLoginMenu && !tempAvailabilityStatus && (
                    <div className="mt-4 text-center">
                      <button
                        className="btn btn-primary"
                        onClick={() => this.props.handleLoginBox()}
                      >
                        {Trans("_pleaseLoginToBook")}
                      </button>
                      {/* {" "} <span style={{ marginLeft: "20px", marginRight: "20px" }}>{Trans("_or")}</span>{" "}
                          <button
                            className="btn btn-primary"
                            onClick={() => this.handleContinueAsGuest()}
                          >
                            {Trans("_continueAsGuest")}
                          </button> */}
                    </div>
                  )
                )}
              </div>
              <div className="col-lg-3">
                {Global.getEnvironmetKeyValue("isCart") === true &&
                  ((Global.getEnvironmetKeyValue("portalType") === "B2B" ||
                    Global.getEnvironmetKeyValue("portalType") === "BOTH") ? (
                    <Link
                      className="btn btn-primary text-white mb-3 w-100"
                      to="/manualbooking"
                    >
                      {Trans("_addMoreItems")}
                    </Link>
                  ) : (
                    <Link
                      className="btn btn-primary text-white mb-3 w-100"
                      to="/manualbooking"
                    >
                      {Trans("_addMoreItems")}
                    </Link>
                  ))}
                {/* <PriceBreakup {...cart} /> */}
              </div>
            </div>
          )}
        </div>
        {this.state.showPopup ? (
          <ModelPopup
            header={this.state.popupTitle}
            content={this.state.popupContent}
            handleHide={this.handleHidePopup}
          />
        ) : null}
      </div>
    );
  }
}

export default CartManualBooking;
